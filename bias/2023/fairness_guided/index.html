<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Fairness-guided Prompting | Shirin Tahmasebi </title> <meta name="author" content="Shirin Tahmasebi"> <meta name="description" content="Fairness-guided Few-shot Prompting for LLMs "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?ce48ee9bc248ee6b18f3aeefc03ed2f9"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://shirintahmasebi.github.io/bias/2023/fairness_guided/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Shirin Tahmasebi </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">CV </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">Publications</a> <a class="dropdown-item " href="/background/">Background</a> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Notes </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/bias/">Bias</a> <a class="dropdown-item " href="/tokenization/">Tokenization</a> <a class="dropdown-item " href="/llm_judge/">LLM as Evaluator</a> <a class="dropdown-item " href="/prompt/">Prompt Engineering</a> <a class="dropdown-item " href="/compression/">LLM Compression</a> <a class="dropdown-item " href="/agents/">LLM Agents</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/recsys/">Recommendation Systems</a> <a class="dropdown-item " href="/other/">Others</a> </div> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Fairness-guided Prompting</h1> <p class="post-meta"> April 02, 2023 </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2023   ·   <i class="fa-solid fa-tag fa-sm"></i> papers   <i class="fa-solid fa-tag fa-sm"></i> weekly-review   <i class="fa-solid fa-tag fa-sm"></i> nlp   </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h2"> <a href="#fairness-guided-few-shot-prompting-for-llms">Fairness-guided Few-shot Prompting for LLMs</a> <ul> <li class="toc-entry toc-h3"><a href="#paper-general-overview">Paper General Overview</a></li> <li class="toc-entry toc-h3"><a href="#prompt-selection-strategies">Prompt Selection Strategies</a></li> <li class="toc-entry toc-h3"><a href="#how-entropy-measures-uncertainty">How Entropy Measures Uncertainty?</a></li> <li class="toc-entry toc-h3"><a href="#experiments-and-results">Experiments and Results</a></li> </ul> </li> </ul> </div> <hr> <div id="markdown-content"> <h2 id="fairness-guided-few-shot-prompting-for-llms"><a href="https://arxiv.org/pdf/2303.13217.pdf" rel="external nofollow noopener" target="_blank">Fairness-guided Few-shot Prompting for LLMs</a></h2> <p>The paper aims to design algorithms that select in-context examples for prompts to enhance the accuracy of language models across various downstream tasks. The central hypothesis is that constructing prompts with less biased in-context examples can improve model accuracy compared to other selection strategies, such as the most similar, diverse, or random examples. They introduce the concept of “predictive bias” as a metric to measure how much a given prompt influences the model’s predictions. Predictive bias refers to the discrepancy in the model’s predictions when presented with different prompts or content-free inputs.</p> <h3 id="paper-general-overview">Paper General Overview</h3> <p>In the paper, the concept of predictive bias is quantified using entropy, specifically the entropy of the model’s predicted distribution. Here’s why entropy is used to measure predictive bias:</p> <p><strong>Ideal Uniform Distribution:</strong> In an ideal scenario, when a model makes predictions in the absence of meaningful information (also knows as “content-free input”), the predicted probabilities should be roughly equal for all possible outcomes. In other words, the model should be uncertain and not favor any particular outcome. This corresponds to a uniform distribution.</p> <p><strong>Measuring Deviation from Uniformity:</strong> Predictive bias refers to the deviation of the model’s predicted distribution from the ideal uniform distribution. When the model’s predictions are biased toward certain outcomes, the entropy of the distribution will be higher because it indicates greater uncertainty and randomness.</p> <p><strong>Entropy as a Quantitative Metric:</strong> Entropy provides a quantitative measure of this uncertainty or randomness. Higher entropy values indicate greater uncertainty and, by extension, a higher degree of predictive bias, as the model’s predictions are more dispersed across different outcomes.</p> <p>So, by calculating the entropy of the predicted distribution generated by the model in response to a content-free input and a prompt, the paper is able to quantify how much the prompt biases the model’s predictions. Lower entropy values imply lower predictive bias, meaning the prompt has less influence on the model’s output. Higher entropy values indicate higher predictive bias, suggesting that the prompt strongly shapes the model’s predictions in a non-uniform way.</p> <h3 id="prompt-selection-strategies">Prompt Selection Strategies</h3> <p><strong>Algorithm 1: T-Fair-Prompting:</strong></p> <ol> <li>For T-Fair-Prompting, each training sample is individually used as an in-context example and passed to the model.</li> <li>The bias (entropy) is measured for each sample’s predictions. Lower entropy indicates lower bias.</li> <li>Samples are sorted by their entropy scores in ascending order (less biased first).</li> <li>The top-k samples with the lowest entropy scores are selected as in-context examples.</li> <li>Computational complexity: \(O(N)\), where \(N\) is the number of training samples.</li> </ol> <p><strong>Algorithm 2: G-Fair-Prompting:</strong></p> <ol> <li>G-Fair-Prompting considers fairness in the combination of remaining training samples and already selected in-context examples.</li> <li>It calculates the fairness score for each possible combination and selects the one that minimizes bias.</li> <li>It operates in an iterative manner, where it gradually builds the prompt by selecting and adding in-context examples. The algorithm continues until it determines that adding more examples will not significantly reduce bias.</li> <li>The approach operates from a local to global perspective, considering individual sample bias initially and then reducing global predictive bias.</li> <li>Computational complexity: \(O(N^2)\), where \(N\) is the number of training samples.</li> </ol> <p>The selected prompts, with in-context examples chosen to minimize bias, are used for inference during downstream tasks. During inference, the model’s accuracy is indeed measured according to the downstream task’s objectives. The goal is to have the model perform well on the specific task it was designed for, and the choice of a more fair prompt is expected to improve the model’s overall accuracy and effectiveness in these tasks.</p> <h3 id="how-entropy-measures-uncertainty">How Entropy Measures Uncertainty?</h3> <p>In this section, a comprehensive explanation is provided regarding how entropy metric can be used to measure the confidence of the model.</p> <p><strong>Entropy as a Measure of Confidence in Language Models:</strong></p> <ul> <li>Entropy is a concept borrowed from information theory and probability theory.</li> <li>In the context of language models, entropy quantifies the uncertainty or disorder in the model’s predicted probability distribution over possible outcomes or classes.</li> <li>It serves as a measure of the model’s confidence in its predictions.</li> <li>High entropy indicates high uncertainty, while low entropy indicates high confidence in predictions.</li> </ul> <p><strong>Entropy calculation:</strong> Here is the entropy formula: \(H = -\Sigma (p_i * log_2^{(p_i)})\), where \(p_i\) represents the probability assigned to each class.</p> <p><strong>Example Scenarios:</strong> Let us consider the two following scenarios:</p> <ol> <li>Scenario 1 (High Confidence): <ul> <li>In this scenario, a language model predicts the probabilities \([1, 0, 0, 0]\) for four classes.</li> <li>Entropy Calculation: \(H = -(1 * log_2^{(1)} + 0 * log_2^{(0)} + 0 * log_2^{(0)} + 0 * log_2^{(0)}) = 0\) (because \(log_2^{(1)}\) is 0)</li> <li>Interpretation: The entropy of 0 indicates that the model is highly confident and certain that the input belongs to the first class, as it assigns a probability of 1 to that class and 0 to all others.</li> </ul> </li> <li>Scenario 2 (Low Confidence): <ul> <li>In this scenario, a language model predicts the probabilities [.25, .25, .25, .25] for four classes.</li> <li>Entropy Calculation: \(\begin{split} H = -(0.25 * log_2^{(0.25)} + 0.25 * log_2^{(0.25)} + 0.25 * log_2^{(0.25)} + 0.25 * log_2^{(0.25)}) = \\ - (0.25 * (-2) + 0.25 * (-2) + 0.25 * (-2) + 0.25 * (-2)) = 2 \end{split}\)</li> <li>Interpretation: The entropy of 2 indicates that the model is very uncertain and evenly distributes its probabilities across all four classes. It lacks confidence in its prediction and is unsure about the correct class.</li> </ul> </li> </ol> <p><strong>Use in Decision-Making:</strong></p> <ul> <li>In classification tasks, entropy can be used as a criterion for decision-making.</li> <li>Higher entropy suggests that the model is uncertain, and additional information may be needed for confident decisions.</li> <li>Lower entropy indicates high confidence in the model’s prediction.</li> </ul> <p>In summary, entropy is a valuable metric for assessing the confidence of a language model’s predictions. It quantifies how spread out or concentrated the predicted probabilities are, with higher entropy indicating greater uncertainty and lower confidence, while lower entropy indicates higher confidence in the model’s predictions.</p> <h3 id="experiments-and-results">Experiments and Results</h3> <p>Here’s the key points from the experimental results:</p> <ol> <li> <p><strong>Model Comparison:</strong> The experiments involve comparing different language models, including BLOOM and various sizes of LLaMA models (e.g., 65B). The choice of LLaMA models is due to API access restrictions for GPT-3.</p> </li> <li> <p><strong>Datasets:</strong> The paper uses several text classification datasets, such as SST-2, AGNews, CoLA, TREC, and RTE. The RTE dataset has sentences that are too long for LLaMA, given its maximum input length of 512.</p> </li> <li> <p><strong>Performance Metrics:</strong> The primary metric for evaluating the strategies is accuracy on the downstream classification tasks.</p> </li> <li> <p><strong>Comparison Strategies:</strong> The paper compares its approach, G-fair-Prompting (Greedy), with two existing strategies, namely, the diversity-guided strategy (Global view) and the similarity-guided strategy (Local view). These strategies select demonstrations from the training set based on diversity or similarity criteria.</p> </li> <li> <p><strong>Performance Findings:</strong></p> <ul> <li> <p><strong>G-fair-Prompting Approximates Enumeration:</strong> G-fair-Prompting is shown to achieve results that closely approximate the performance of enumerating all possible candidates. This indicates that G-fair-Prompting is effective in finding high-quality prompts.</p> </li> <li> <p><strong>Outperformance of T-fair-Prompting:</strong> G-fair-Prompting consistently outperforms T-fair-Prompting, another strategy proposed in the paper. This demonstrates that the greedy search approach of G-fair-Prompting is more effective in improving prompt quality.</p> </li> <li> <p><strong>Importance of the Number of Demonstrations:</strong> The experiments show that selecting a smaller number of demonstrations (Top-2) can significantly outperform selecting more demonstrations (Top-4) in most cases. This suggests that the number of demonstrations chosen plays a crucial role in prompt quality.</p> </li> </ul> </li> </ol> <p>Overall, the results demonstrate that G-fair-Prompting is an effective approach for selecting demonstrations and improving prompt quality for different language models and datasets, achieving performance close to enumeration but with lower computational costs.</p> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Shirin Tahmasebi. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?7254ae07fe9cc5f3a10843e1c0817c9c" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>