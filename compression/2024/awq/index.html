<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> AWQ | Shirin Tahmasebi </title> <meta name="author" content="Shirin Tahmasebi"> <meta name="description" content="Activation-aware Weight Quantization "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?ce48ee9bc248ee6b18f3aeefc03ed2f9"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://shirintahmasebi.github.io/compression/2024/awq/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Shirin Tahmasebi </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">CV </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">Publications</a> <a class="dropdown-item " href="/background/">Background</a> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Notes </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/bias/">Bias</a> <a class="dropdown-item " href="/tokenization/">Tokenization</a> <a class="dropdown-item " href="/llm_judge/">LLM as Evaluator</a> <a class="dropdown-item " href="/prompt/">Prompt Engineering</a> <a class="dropdown-item " href="/compression/">LLM Compression</a> <a class="dropdown-item " href="/agents/">LLM Agents</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/recsys/">Recommendation Systems</a> <a class="dropdown-item " href="/other/">Others</a> </div> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">AWQ</h1> <p class="post-meta"> July 17, 2024 </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2024   ·   <i class="fa-solid fa-hashtag fa-sm"></i> compression   <i class="fa-solid fa-hashtag fa-sm"></i> quantization   </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h2"> <a href="#awq-activation-aware-weight-quantization-for-on-device-llm-compression-and-acceleration">AWQ: Activation-aware Weight Quantization for On-Device LLM Compression and Acceleration</a> <ul> <li class="toc-entry toc-h3"><a href="#introduction">Introduction</a></li> <li class="toc-entry toc-h3"><a href="#research-gap">Research Gap</a></li> <li class="toc-entry toc-h3"><a href="#solution-awq">Solution: AWQ</a></li> <li class="toc-entry toc-h3"><a href="#conclusion">Conclusion</a></li> </ul> </li> </ul> </div> <hr> <div id="markdown-content"> <h2 id="awq-activation-aware-weight-quantization-for-on-device-llm-compression-and-acceleration"><a href="https://arxiv.org/pdf/2306.00978" rel="external nofollow noopener" target="_blank">AWQ: Activation-aware Weight Quantization for On-Device LLM Compression and Acceleration</a></h2> <h3 id="introduction">Introduction</h3> <p>Large Language Models (LLMs) have revolutionized natural language processing by enabling near-human performance in tasks like text generation, code completion, and conversational AI. However, the hardware and memory overhead of running these massive models on small devices (e.g., mobile phones, edge servers) remain prohibitively high. To address this challenge, recent efforts have turned to quantization to achieve efficient on-device inference. Among these approaches, weight-only quantization strikes a strong balance between feasibility and performance, lowering overall storage without adding much computational overhead. This paper introduces Activation-aware Qunatization (AWQ), which is a weight-only Post-Training Quantization (PTQ) method that converts full-precision LLM weights to 4-bit integers without requiring any fine-tuning or backpropagation.</p> <h3 id="research-gap">Research Gap</h3> <p>Despite the advantages of weight-only quantization, straightforward “round-to-nearest” methods can cause significant drops in accuracy, especially under low-bit settings such as 4-bit integer precision. Additionally, many advanced techniques rely on either partial retraining (which can be expensive) or heavy data requirements for calibrating weights, both of which can diminish the appeal of a truly lightweight, post-training solution. The paper addresses this gap by introducing AWQ, which specifically protects the small fraction of “salient” input neurons that have a disproportionately large effect on the model’s output—thereby greatly reducing quantization error without requiring any fine-tuning or large-scale data.</p> <h3 id="solution-awq">Solution: AWQ</h3> <p>AWQ is a weight-only Post-Training Quantization (PTQ) method that converts full-precision LLM weights to 4-bit integers without requiring any fine-tuning or backpropagation. It simply measures which input neurons (dimensions) get the largest activations and pre-scales the corresponding weights to mitigate rounding errors. Everything is done after the model is trained, using only a small calibration set to gather activation statistics.</p> <p>The core insight is that not all weights matter equally—specifically, the weights connected to input neurons with large activations have a bigger impact on the model’s output. AWQ identifies those “salient” neurons based on their average activation magnitude (collected from a small calibration set) and scales up their weights before rounding them to 4 bits. This scaling step reduces the relative rounding error for the crucial (high-activation) neurons, preserving model quality without needing any full-blown re-training. The end result is a hardware-friendly approach that achieves significant memory reduction and speedups on GPUs and other edge devices, all while maintaining strong performance across language, coding, and even multi-modal tasks.</p> <p>Here’s a concise summary of how AWQ works:</p> <ol> <li> <strong>Collect Activation Statistics</strong> <ul> <li>For each linear layer in an LLM, gather the <strong>average activation</strong> seen by each <em>input neuron</em> on a small calibration dataset.</li> <li>An <em>input neuron</em> here means a single dimension of the layer’s input vector.</li> </ul> </li> <li> <strong>Identify Salient Input Neurons</strong> <ul> <li>Based on these average activation values, a small subset (e.g., ~0.1–1%) of <em>input neurons</em> will stand out because their average activations are significantly higher. These are termed “salient,” since a small quantization error there can cause a large error in the layer’s output.</li> </ul> </li> <li> <strong>Apply Input-Neuron-Specific Scaling</strong> <ul> <li>Before quantizing the layer’s weights to 4 bits, multiply the weights corresponding to each <em>input neuron</em> by a scaling factor.</li> <li> <p>Crucially, the factor depends on the neuron’s average activation value:</p> \[\text{Scaling Factor}[i] \;=\; \bigl(\text{avg_act}[i]\bigr)^{\alpha},\] <p>where \(\alpha\) is chosen via a quick grid search between [0,1]. This ensures that <em>salient</em> neurons (the ones with larger activations) get a bigger boost.</p> </li> </ul> </li> <li> <strong>Quantize All Weights</strong> <ul> <li>After scaling is applied to each neuron’s weights, the entire layer is quantized to a unified 4-bit format.</li> <li>Because the weights for <em>salient</em> neurons were scaled up in advance, their <em>relative</em> rounding error is smaller, improving overall accuracy.</li> </ul> </li> <li> <strong>Preserve the Model’s Computation</strong> <ul> <li>To keep the final numerical outputs consistent, the input activations can be proportionally adjusted (scaled down) during inference. This is effectively the same operation as the original layer multiplication, but now it has better resilience to 4-bit rounding errors where it matters most (the salient neurons).</li> </ul> </li> </ol> <p>In short, AWQ detects which <em>input neurons</em> handle large activation values, scales up their associated weights before 4-bit rounding, and thereby protects the most important pathways in the network without resorting to slow or memory-heavy mixed-precision.</p> <h3 id="conclusion">Conclusion</h3> <p>In essence, AWQ bridges a critical need in practical LLM deployment by facilitating efficient model compression while preserving strong performance. By identifying and scaling the most impactful weight columns based on activation statistics, it cuts down memory and latency costs without compromising the robustness or accuracy of the model. This allows large-scale language models to be more readily deployed on resource-constrained devices, democratizing access to cutting-edge NLP capabilities in real-world settings—from mobile assistants to embedded IoT applications.</p> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Shirin Tahmasebi. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?7254ae07fe9cc5f3a10843e1c0817c9c" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>